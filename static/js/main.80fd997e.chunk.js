(this["webpackJsonpcurnon-ninjump"]=this["webpackJsonpcurnon-ninjump"]||[]).push([[0],{27:function(e,t,a){e.exports=a(55)},29:function(e,t,a){},55:function(e,t,a){"use strict";a.r(t);var r=a(3),n=a.n(r),i=a(4),o=a(5),c=(a(29),a(0)),d=a(1),l=function(){},s=function(e){var t=e.update,a=void 0===t?l:t,r=e.destroy;return{update:a,destroy:void 0===r?l:r}},h=a(18),f=a.n(h),u=a(2),p=function(e,t,a,r){for(var n=a.findRegion("deadline-back-gradient"),i=a.findRegion("deadline-front-gradient"),o=a.findRegion("single-note"),l=a.findRegion("single-paper"),s=a.findRegion("deadline-base"),h=a.findRegion("paper_stack"),f=Object(c.c)(.1,a.findRegions("paper_stack")),p=e/30,g=e,j=g/n.width*n.height,y=t-j,v=g/s.width*s.height,w=t-v/2,O=g/i.width*i.height,b=t-O,m=e/4,P=m/h.width*h.height,z=t-P,S=[],x=0;x<4;x++)S[x]=.5*Math.random();var M=0,R=.15,_=[],L=-t/2,N=.75*t;return{setDeadLineParticleRate:function(e){R=e},getDeadLineParticleRate:function(){return R},update:function(a,c){for(M+=a;M>=R;){M-=R;var h=Math.random()>.5?0:1;_.push({x:Math.random()*e,y:t,size:0===h?2*p:p,speedY:L,type:h,rotation:Math.random()*Math.PI/2})}var j,x=Object(d.a)(_);try{for(x.s();!(j=x.n()).done;){var C=j.value;C.speedY+=N*a,C.y=C.y+C.speedY*a,C.y>t&&(C.expired=!0)}}catch(T){x.e(T)}finally{x.f()}for(var I=_.length-1;I>=0;I--)_[I].expired&&_.splice(I,1);n.draw(r,0,y,g,y),s.draw(r,0,w,g,v);for(var A=0;A<3;A++)f.getKeyFrame(c+S[A],u.a.LOOP_PINGPONG).draw(r,m*A+m/2,z-P/8,m,P);var F,K=Object(d.a)(_);try{for(K.s();!(F=K.n()).done;){var G=F.value;(0===G.type?l:o).draw(r,G.x,G.y,G.size,G.size,G.size/2,G.size/2,G.rotation)}}catch(T){K.e(T)}finally{K.f()}for(var Y=0;Y<4;Y++)f.getKeyFrame(c+S[Y],u.a.LOOP_PINGPONG).draw(r,m*Y,z,m,P);i.draw(r,0,b,g,O)}}},g=[],j=function(e,t,a){g.length=0;for(var r=a;r>e;)r-=t;for(;r<-t;)r+=t;var n=r;do{g.push(r),r+=t}while(r<e);for(r=n;r>0;)r-=t,g.push(r);return g},y=function(e,t,a,r,n){var i=e,o=i/a.width*a.height,c=i/r.width*r.height;return{update:function(e,l,s){var h,f=j(t,c,.5*(-l+s)),u=Object(d.a)(f);try{for(u.s();!(h=u.n()).done;){var p=h.value;n.draw(r,0,p,i,c)}}catch(w){u.e(w)}finally{u.f()}f=j(t,o,-l+s);var g,y=Object(d.a)(f);try{for(y.s();!(g=y.n()).done;){var v=g.value;n.draw(a,0,v,i,o)}}catch(w){y.e(w)}finally{y.f()}}}},v=function(e,t,a,r,n){var i=[],o=0,c=e/30,l=e/7.5;return{update:function(e,t,a,r){for(o+=e;o>=.075;)o-=.075,i.push({x:t+n/2+(Math.random()-.5)*l,y:a+n/2+(Math.random()-.5)*l,speedY:r/2,type:Math.random()<.3?0:Math.random()<.5?1:2,rotation:Math.random()*Math.PI/2,duration:3*Math.random(),t:0,size:c});var s,h=Object(d.a)(i);try{for(h.s();!(s=h.n()).done;){var f=s.value;f.t+=e,f.y+=f.speedY*e}}catch(g){h.e(g)}finally{h.f()}for(var u=i.length-1;u>=0;u--){var p=i[u];p.t>=p.duration&&i.splice(u,1)}},draw:function(){var e,t=Object(d.a)(i);try{for(t.s();!(e=t.n()).done;){var n=e.value,o=(n.duration-n.t)/n.duration;o=o*o*(3-2*o),r.setColor(0,0,0,.75*o),r.draw(a,n.x-n.size/2+n.size/5,n.y-n.size/2+n.size/5,n.size,n.size,n.size/2,n.size/2,n.rotation),0===n.type&&r.setColor(1,.494,.725,o),1===n.type&&r.setColor(.478,.988,1,o),2===n.type&&r.setColor(1,.969,.251,o),r.draw(a,n.x-n.size/2,n.y-n.size/2,n.size,n.size,n.size/2,n.size/2,n.rotation),r.setColor(1,1,1,1)}}catch(c){t.e(c)}finally{t.f()}}}},w=function(e,t,a,r,n,i,o){var c=n,d=e/10;return{update:function(o,l,s){for(var h=l+s,f=a.length-1;f>=0;f--){a[f]-n>h&&a.splice(f,1)}for(var u=r.length-1;u>=0;u--){r[u].y>a[0]&&r.splice(u,1)}for(;c>h-2*t-n;)if(c-=n,a.push(c),!(c>-t)&&Math.random()<=.2){var p=Math.floor(4*Math.random()),g=Math.random()>.5?0:1,j=0===p?3*d:2*d,y=0===p?d/2:2*d;r.push({wallIndex:g,y:0===p?c-n:c-n-.9*y,type:p,width:j,height:y,x:0===g?i:e-i-j})}}}},O=function(e,t,a,r,n,i,o){return{draw:function(){r.setColor(0,0,0,.75);var t,l=Object(d.a)(n);try{for(l.s();!(t=l.n()).done;){var s=t.value;Object(c.g)(r,a,0,s-i,o,i),Object(c.g)(r,a,e-o,s-i,o,i)}}catch(h){l.e(h)}finally{l.f()}r.setColor(1,1,1,1)}}},b=function(e,t,a,r,n,i,o,d,l,s){var h="".concat(0===l?"man":"girl","_running_").concat(s+1),f="".concat(0===l?"man":"girl","_jump_").concat(s+1),p=r.findRegions(h),g=r.findRegions(f),j=Object(c.c)(.05,p),y=Object(c.c)(.1,g),v=Object(c.c)(.05,i.findRegions("bullet_hit").slice(1,-1)),w=n.findRegions("slash"),O=Object(c.c)(.03,w),b=Object(c.c)(.1,o.findRegions("watch_buff")),m=.1*e,P=.8*e,z=P*w[0].height/w[0].width,S=!0;return{draw:function(e,t,n,i,o,w,x,M,R){s!==M&&function(e){console.log("update outfit",e),h="".concat(0===l?"man":"girl","_running_").concat(e+1),f="".concat(0===l?"man":"girl","_jump_").concat(e+1),p=r.findRegions(h),g=r.findRegions(f),j=Object(c.c)(.05,p),y=Object(c.c)(.1,g)}(s=M);var _=d/2,L=n?1:-1;if(R>o-.1)return a.setColor(.478,.988,1,1),v.getKeyFrame(o-R,u.a.LOOP_PINGPONG).draw(a,e,t,2*d,d),void a.setColor(1,1,1,1);if(S||O.getKeyFrame(o-w,u.a.NORMAL).draw(a,m,t,P,z,P/2,z/2,0,L,1.5),i?(S=!1,y.getKeyFrame(o-w,u.a.NORMAL).draw(a,e,t,150*d/115,d,_,0,0,L,1)):j.getKeyFrame(o,u.a.LOOP_PINGPONG).draw(a,e,t,d,d,_,0,0,L,1),x>=o){var N=b.getKeyFrame(o-(x-2.5),u.a.LOOP_PINGPONG);N&&N.draw(a,e,t,d,d,d/2,d/2,0,1.5,1.5)}}}},m=function(e,t,a,r,n,i,o){var l=new c.b;return{update:function(t,s,h){var f,u=Object(d.a)(a);try{for(u.s();!(f=u.n()).done;){var p=f.value;if(p.type>0&&!p.fired&&Math.abs(p.y-s)<r){p.fired=!0,p.projectilePos=new c.b(0===p.wallIndex?n:e-n,p.y);var g=new c.b;g.set(0===p.wallIndex?i:-i,0);var j=-Math.random()*Math.PI/6-Math.PI/18;g.rotateRad(0===p.wallIndex?j:-j),p.projectileVel=g,p.projectileSize=o,p.projectileStart=h}p.fired&&(l.setVector(p.projectileVel).scale(t),p.projectilePos.addVector(l))}}catch(y){u.e(y)}finally{u.f()}}}},P=[null,"bed","bath","tivi"],z=function(e,t,a,r){for(var n=[],i=[],o=[],l=Object(c.c)(.05,r.findRegions("bullet_hit").slice(1,-1)),s=Object(c.c)(.05,r.findRegions("coin")),h=0;h<P.length;h++)if(0!==h){var f=r.findRegions(P[h]);n[h]=Object(c.c)(.1,f),i[h]=Object(c.c)(.1,f.slice(0,4)),o[h]=Object(c.c)(.1,r.findRegions("".concat(P[h],"_bullet")))}return{draw:function(r){var h,f=Object(d.a)(a);try{for(f.s();!(h=f.n()).done;){var p=h.value,g=0===p.wallIndex?-1:1;0===p.type?(t.setColor(0,0,0,.75),!p.hit&&Object(c.g)(t,e,p.x,p.y,p.width,p.height),t.setColor(1,1,1,1)):p.fired?(!p.hit&&n[p.type].getKeyFrame(r-p.projectileStart,u.a.NORMAL).draw(t,p.x,p.y,p.width,p.height,p.width/2,p.height,0,1.5*g,1.5),p.projectileHit?r-p.projectileHitTime<=.55&&(t.setColor(0,0,0,.25),l.getKeyFrame(r-p.projectileHitTime,u.a.NORMAL).draw(t,p.projectilePos.x-p.projectileSize,p.projectilePos.y,2*p.projectileSize,p.projectileSize,p.projectileSize,p.projectileSize/2,0,1.5,1.5),t.setColor(1,1,1,1),l.getKeyFrame(r-p.projectileHitTime,u.a.NORMAL).draw(t,p.projectilePos.x-p.projectileSize+.05*p.projectileSize,p.projectilePos.y+.05*p.projectileSize,2*p.projectileSize,p.projectileSize,p.projectileSize,p.projectileSize/2,0,1.5,1.5),s.getKeyFrame(r-p.projectileHitTime,u.a.NORMAL).draw(t,p.projectilePos.x,p.projectilePos.y+p.projectileSize/2,p.projectileSize,p.projectileSize/8*10,p.projectileSize/2,0,0,2,2)):o[p.type].getKeyFrame(r,u.a.LOOP_PINGPONG).draw(t,p.projectilePos.x-p.projectileSize/2,p.projectilePos.y-p.projectileSize/2,p.projectileSize,p.projectileSize,p.projectileSize/2,p.projectileSize/2,0,1.2,1.2)):!p.hit&&i[p.type].getKeyFrame(r,u.a.LOOP_PINGPONG).draw(t,p.x,p.y,p.width,p.height,p.width/2,p.height,0,1.5*g,1.5)}}catch(j){f.e(j)}finally{f.f()}}}},S=function(e,t,a,r,n,i,o,l){for(var s="ob_".concat(0===o?"man":"girl"),h=[null,"".concat(s,"_2"),"".concat(s,"_3"),"".concat(s,"_1")],f=i.findRegion("ob_man_1"),p=e/2,g=p*f.height/f.width,j=[],y=0;y<h.length;y++)if(0!==y){var v=i.findRegions(h[y]);j[y]=Object(c.c)(.05,v)}return{draw:function(i,o){n.length>0&&(r.setColor(0,0,0,.5),Object(c.g)(r,a,0,o-t,e,2*t),r.setColor(1,1,1,1));var l,s=Object(d.a)(n);try{for(s.s();!(l=s.n()).done;){var h=l.value;if(0!==h.type)j[h.type].getKeyFrame(i-h.time,u.a.NORMAL).draw(r,h.x-p/2,o+2*h.offsetY-g/2,p,g,p/2,g/2,0,h.flipped?1:-1,1)}}catch(f){s.e(f)}finally{s.f()}}}},x=function(e,t,a){var r=e/5,n=5;return{update:function(i,o,c){(n-=i)<=0&&(n=5*Math.random()-2.5+5,a.push({x:e/2,y:c-t,drawX:e/2,drawY:c-t,drawScale:1,time:o,width:r,height:r,type:Math.floor(3*Math.random())}));for(var d=a.length-1;d>=0;d--)a[d].y>c+2*t&&a.splice(d,1)}}},M=function(e,t,a,r,n,i){for(var o=[],l=0;l<3;l++)o.push(Object(c.c)(.1,r.findRegions("watch_".concat(l+1))));return{draw:function(e,t,r){var c,l=Object(d.a)(n);try{for(l.s();!(c=l.n()).done;){var s=c.value;e-s.hitTime>.5||(s.hit&&(s.drawX=s.drawX+.2*(t+i/2-s.drawX),s.drawY=s.drawY+.2*(r-s.drawY),s.drawScale=s.drawScale+.2*(.5-s.drawScale)),o[s.type].getKeyFrame(e,u.a.LOOP).draw(a,s.drawX-s.width/2,s.drawY-s.height/2,s.width,s.height,s.width/2,s.height/2,0,s.drawScale,s.drawScale))}}catch(h){l.e(h)}finally{l.f()}}}},R=function(){var e=Object(o.a)(n.a.mark((function e(t){var a,r,i,o,l,h,u,g,j,P,R,_,L,N,C,I,A,F,K,G,Y,T,H,k,E,V,X,B,D,J,U,q,Q,W,Z,$,ee,te,ae,re,ne,ie,oe,ce,de,le,se,he,fe,ue,pe,ge,je,ye,ve,we,Oe,be,me,Pe,ze,Se,xe,Me,Re,_e,Le,Ne;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.gender,r=void 0===a?0:a,i=t.gl,o=t.width,l=t.height,h=t.canvas,u=t.assets,g=0,j=Object(c.d)(i),P=Object(c.f)(o,l,o,l),R=f()(i),_=new c.a(h),L=u.bg1,N=u.bg2,C=u.deadLineAtlas,I=u.characterAtlas,A=u.slashAtlas,F=u.obstacleAtlas,K=u.noteTex,G=u.watchAtlas,Y=o/L.width*L.height,H=Y/7,k=2*o,V=0,X=0,B=function(){return V>=Le},D=T=.05*o,J=0,U=0,q=.75*-l,W=Q=.6*l,Z=Q,$=!1,ee=!1,te=[],ae=[],re=T,ne=o-T-(E=o/5),ie=0,oe=function(){ee||ae.length>0||(J=$?-k:k,ee=!0,ie=Le)},_.addEventListener("touchStart",oe),document.addEventListener("keydown",oe),ce=function(e){if(ee){var t=!1;return e>ne&&(D=ne,t=!0),e<re&&(D=re,t=!0),t&&(J=0,ee=!1,$=!$),t}},de=function(e){var t=1;ae.length>0&&(t=.5),B()&&(t*=2),U+=q*e*t;var a=J*e;ce(D+a)||(D+=a)},le=function(e){var t,a=D,r=D+E,n=U,i=U+E,o=Object(d.a)(je);try{for(o.s();!(t=o.n()).done;){var c=t.value;if(!c.hit){var l=c.x-c.width/2,s=c.x+c.width/2,h=c.y-c.height/2,f=c.y+c.height/2;a<s&&r>l&&n<f&&i>h&&(c.hit=!0,c.hitTime=Le,V=Le+2.5,Z+=.5*(Q-Z))}}}catch(u){o.e(u)}finally{o.f()}},se=function(e){var t,a=D,r=D+E,n=U,i=U+E,c=!1,s=Object(d.a)(ge);try{for(s.s();!(t=s.n()).done;){var h=t.value;if(!h.hit){var f=h.width,u=h.height,p=h.x,g=h.x+f,j=h.y,y=h.y+u;a<g&&r>p&&n<y&&i>j&&!ee&&(h.hit=!0,B()||(c=!0,ae.push({time:Le,duration:1,type:h.type,x:o/2+(Math.random()-.5)*o/20,offsetY:-(Math.random()*o/20+o/40),flipped:$})))}}}catch(R){s.e(R)}finally{s.f()}var v,w=Object(d.a)(ge);try{for(w.s();!(v=w.n()).done;){var O=v.value;if(O.fired&&!O.projectileHit){var b=O.projectilePos,m=O.projectileSize,P=b.x-m/3,z=b.x+m/3,S=b.y-m/3,x=b.y+m/3;a<z&&r>P&&n<x&&i>S&&(O.projectileHit=!0,O.projectileHitTime=Le,O.projectileVel.set(0,q),ee||B()?(W+=.2*(Q-W),X+=5):(ae.push({time:Le,duration:1,type:O.type,x:o/2+(Math.random()-.5)*o/10,offsetY:-(Math.random()*o/10+o/20),flipped:$}),O.projectileVel.set(0,q/2),c=!0))}}}catch(R){w.e(R)}finally{w.f()}if(c){W+=.2*(l-W);var M=we.getDeadLineParticleRate();we.setDeadLineParticleRate(M+.2*(pe-M))}},he=-2,fe=[0,50,200],ue=function(){for(var e=0;e<fe.length;e++)g>=e||X>fe[e]&&(g=e,he=Le)},pe=.015,ge=[],je=[],ye=o,ve=o/7.5,we=p(o,l,C,j),Oe=y(o,l,L,N,j),be=v(o,0,K,j,E),me=w(o,l,te,ge,H,T),Pe=O(o,0,R,j,te,H,T),ze=b(o,0,j,I,A,F,G,E,r,g),Se=m(o,0,ge,H,T,ye,ve),xe=z(R,j,ge,F),Me=S(o,l,R,j,ae,F,r),Re=x(o,l,je),_e=M(0,0,j,G,je,E),Le=0,Ne=function(e){B()&&(ae.length=0),Z+=.02*(W-Z);for(var t=ae.length-1;t>=0;t--)Le-ae[t].time>=ae[t].duration&&ae.splice(t,1);Le+=e,be.update(e,D,U,q),de(e),se(),le(),ue(),Se.update(e,U,Le),me.update(e,U,Z),Re.update(e,Le,U),P.setPosition(0,0),j.setProjection(P.combined),j.begin(),Oe.update(e,U,Z),we.update(e,Le),j.end(),P.setPosition(0,U-Z),j.setProjection(P.combined),j.begin(),be.draw(),ze.draw(D,U,$,ee,Le,ie,V,g,he),_e.draw(Le,D,U),Pe.draw(),xe.draw(Le),Me.draw(Le,U),j.end()},e.abrupt("return",s({update:Ne,destroy:function(){_.cleanup(),document.removeEventListener("keydown",oe)}}));case 60:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(function(){var e=Object(o.a)(n.a.mark((function e(){var t,a,r,o,d,l,s,h,f,u,p,g,j,y,v,w,O,b,m,P,z,S;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("main"),a=document.getElementById("loading"),r=Object(c.j)(t,1),o=Object(i.a)(r,2),d=o[0],l=o[1],s=t.getContext("webgl"),h={width:d,height:l,canvas:t,gl:s,pixelRatio:1,setCurrentScreen:function(e){h.currentScreen&&h.currentScreen.destroy(),h.currentScreen=e}},f=0,a.innerHTML="Loading (".concat(f," / 7)..."),u=function(e){return e.then((function(e){return f++,a.innerHTML="Loading (".concat(f," / 8)..."),e}))},e.next=10,Promise.all([u(Object(c.i)(s,"./test-bg.png")),u(Object(c.i)(s,"./test-bg2.jpg")),u(Object(c.h)(s,"./deadline.atlas")),u(Object(c.h)(s,"./test.atlas")),u(Object(c.h)(s,"./slash.atlas")),u(Object(c.h)(s,"./obstacle.atlas")),u(Object(c.i)(s,"./note.png")),u(Object(c.h)(s,"./watch.atlas"))]);case 10:return p=e.sent,g=Object(i.a)(p,8),j=g[0],y=g[1],v=g[2],w=g[3],O=g[4],b=g[5],m=g[6],P=g[7],z={bg1:j,bg2:y,deadLineAtlas:v,characterAtlas:w,slashAtlas:O,obstacleAtlas:b,noteTex:m,watchAtlas:P},h.assets=z,e.t0=h,e.next=25,R(h);case 25:e.t1=e.sent,e.t0.setCurrentScreen.call(e.t0,e.t1),a.style.display="none",s.clearColor(1,1,1,1),S=function(e){s.clear(s.COLOR_BUFFER_BIT),h.currentScreen&&h.currentScreen.update(e)},Object(c.e)(S);case 31:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}},[[27,1,2]]]);
//# sourceMappingURL=main.80fd997e.chunk.js.map